---
title: Whistle
pubDatetime: 2024-02-20T04:06:31Z
slug: whistle
featured: false
draft: false
tags:
  - å·¥å…·
description: Whistle + SwitchyOmega æŠ“åŒ… & è°ƒè¯•ã€‚
---

[Whistle](https://github.com/avwo/whistle) æ˜¯ä¸€æ¬¾åŸºäº `Node` å®ç°çš„è·¨å¹³å°æŠ“åŒ…è°ƒè¯•å·¥å…·ï¼Œç±»ä¼¼äº [Fiddler](https://www.telerik.com/fiddler)ï¼Œ

å¦‚æœä½ å·²ç»ç†Ÿç»ƒä½¿ç”¨ [Fiddler](https://www.telerik.com/fiddler)ï¼Œå¯ä»¥è·³è¿‡æ­¤æ–‡ã€‚

## Table of contents

## èƒŒæ™¯

å›æ­¦æ±‰ä¸€æ®µæ—¶é—´åï¼Œé‡åˆ°äº†ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é¡¹ç›®ã€‚

**é¡¹ç›®æœ¬åœ°æ— æ³•è¿è¡Œï¼Œä½†æ˜¯ä½ è¦åšéœ€æ±‚ï¼š**

`JSP` + `jQuery` è‡³å°‘ 10 å¹´çš„å¤è€é¡¹ç›®ï¼Œç‰ˆæœ¬æ§åˆ¶ç”¨çš„ `SVN`ã€‚

æ•´ä¸ªä»“åº“ç®¡ç†å‘˜åªç»™å‰ç«¯å¼€äº† `/static/` ç›®å½•çš„æƒé™ï¼Œ

æ²¡æœ‰ `Java` çš„ä»£ç ï¼Œå‰ç«¯éƒ½æ˜¯çº¯é™æ€æ–‡ä»¶ï¼š`*.html` `*.js` `*.css`ï¼Œ

~~å½“ç„¶ï¼Œå°±ç®—æœ‰å…¨å¥—ä»£ç ï¼Œä½ ä¹Ÿæ²¡åŠæ³•æŠŠé¡¹ç›®è·‘èµ·æ¥...~~

ğŸ˜… æ¯•ç«Ÿä¸€å¥— `JDK` ç¯å¢ƒçš„å®‰è£…ï¼Œä»¥åŠ `MySQL` `Redis` ç­‰ç¯å¢ƒçš„å†…ç½‘è®¿é—®ç”³è¯·åˆè¦æŠ˜è…¾å¾ˆä¹…...

åœ¨é¡¹ç›®æ— æ³•è¿è¡Œï¼Œå‰ç«¯å…¨æ˜¯é™æ€æ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œéœ€è¦è¿›è¡Œéœ€æ±‚å¼€å‘ï¼Œå„ä¸ªç¯å¢ƒè°ƒè¯•ç­‰ç­‰ã€‚

**å„ç§ location.replace() å¯¼è‡´çœ‹ä¸åˆ°è¿”å›å€¼ï¼š**

å¦‚æœåœ¨åº”ç”¨ A è°ƒç”¨æŸä¸ªæ¥å£ï¼Œå†ä½¿ç”¨ `location.replace(){:js}` â€œé‡å®šå‘â€ åˆ°åº”ç”¨ Bï¼Œ

åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°å°±æ— æ³•çœ‹åˆ°æ¥å£çš„è¿”å›ã€‚

å¶å°”åº”ç”¨ B åˆä¼šæ‹¿åˆ° A æºå¸¦çš„ `query params` å†è°ƒç”¨å…¶ä»–æ¥å£åç»§ç»­ â€œé‡å®šå‘â€ï¼Œ

å‡ ä¸ªå…³é”®æ¥å£çœ‹ä¸åˆ°è¿”å›...

å³ä¾¿ä»£ç ä¸­ç”¨ `console.log(){:js}` æ‰“å°äº†è¿”å›å€¼ï¼Œæµè§ˆå™¨æ§åˆ¶å°ä¹Ÿæ— æ³•å±•å¼€è¿™ä¸ªå¯¹è±¡ã€‚

è€Œä¸”ä½ è¿˜éœ€è¦ä¸€ç›´æŠŠ `XHR` å’Œ `Console` ä¸­çš„ `Preserve log` ä¿æŒå¼€å¯...

ğŸ˜µâ€ğŸ’« æ¥å£æ²¡æ–‡æ¡£ï¼Œè°ƒè¯•è¿˜çœ‹ä¸åˆ°è¿”å›å€¼ã€‚

**å°†ç¯å¢ƒå˜é‡ç¡¬ç¼–ç åˆ°ç¯å¢ƒåˆ†æ”¯ï¼š**

å¾®å‰ç«¯æ¶æ„çš„é¡¹ç›®ï¼Œé‡Œé¢å·®ä¸å¤šæœ‰ 10 ä¸ªå­é¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®éƒ½æœ‰å„è‡ªçš„ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œ

è¿™äº›æ–‡ä»¶æ²¡æœ‰è§„åˆ™ï¼Œé™¤éä½ å•ƒä»£ç æ‰¾åˆ°å“ªäº›å¸¸é‡å±äºç¯å¢ƒå˜é‡...

æ™®éçš„ workfollowï¼Œæˆ‘ä»¬ä¼šä» `prod` æˆ– `master` åˆ†æ”¯ `git checkout -b feature-branch{:shell}` ï¼Œ

è€Œåå°† `feature-branch` å¾€ä¸åŒçš„ç¯å¢ƒåˆ†æ”¯ï¼Œå¦‚ï¼š`dev` `beta` `uat` ç­‰ä¸Šé¢åˆå¹¶ï¼Œå†å‘å¸ƒå¯¹åº”çš„ç¯å¢ƒã€‚

ä½†æ˜¯è¿™ä¸ªé¡¹ç›®ï¼Œå°†å„ç§ç¯å¢ƒçš„å¸¸é‡æäº¤åˆ°äº† `evn-branch`ï¼Œæœ€åˆæ˜¯ä» `dev` å¼€å§‹æ¬ä»£ç ï¼Œä¸€ç›´æ¬åˆ° `prod`ã€‚

åé¢å¼€å‘å…¨éƒ¨ä½¿ç”¨ `cherry-pick` è¿›è¡Œä»£ç åˆå¹¶...

ä»å“ªä¸ª `env-branch` åˆ‡åˆ†æ”¯ï¼Œä½ æœ¬åœ°è¿è¡Œé¡¹ç›®åå°±åªä¼šæ‰è¿™ä¸ª `env` ç¯å¢ƒçš„ä¸œè¥¿ï¼Œ

ä½ æƒ³åˆ‡ç¯å¢ƒï¼Ÿæ”¾å¼ƒå§ï¼

## ä½¿ç”¨ Whistle

ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘éœ€è¦ä¸€ä¸ªå·¥å…·ï¼š

- ä½¿ç”¨æœ¬åœ°æ–‡ä»¶è°ƒè¯•è¿œç¨‹æ–‡ä»¶ï¼›
- å¯¹æ¥å£è¿›è¡ŒæŠ“åŒ…ï¼›
- å°†æŒ‡å®šçš„åŸŸåè½¬å‘åˆ°å¦ä¸€ä¸ªåŸŸåï¼›

ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„æ˜¯ [Fiddler](https://www.telerik.com/fiddler)ï¼Œä½†æ˜¯å®ƒå¤ªé‡äº†ï¼Œæœ€åé€‰æ‹©äº† [Whistle](https://github.com/avwo/whistle)ã€‚

### å®‰è£…

[Whistle](https://github.com/avwo/whistle) æœ¬èº«æ˜¯ä¸€ä¸ª `npm` åŒ…ï¼Œå’Œå®‰è£…å…¶ä»–åŒ…ä¸€æ ·ï¼Œå…¨å±€å®‰è£…å®ƒå³å¯ï¼š

```shell
npm i -g whistle

# Or ä½¿ç”¨é•œåƒ

npm i -g whistle --registry=https://registry.npmmirror.com
```

å®‰è£…å®Œæ¯•åï¼Œ[Whistle](https://github.com/avwo/whistle) ä¼šæ³¨å†Œå…¨å±€çš„ binï¼š`w2`ï¼Œ

ä½ å¯ä»¥æ‰§è¡Œ `w2 help{:shell}` æ¥åˆ¤æ–­æ˜¯å¦å®‰è£…æˆåŠŸã€‚

### åˆå§‹åŒ–

> åœ¨å®‰è£…ä¹‹å‰ï¼Œå»ºè®®å°†æœ¬æœºå·²æœ‰çš„å…¨å±€ä»£ç†ï¼ˆä¾‹å¦‚ï¼šClashX ç­‰ï¼‰å…³é—­ã€‚
>
> `w2` é»˜è®¤ä»£ç†ç«¯å£ä¸º 8899ï¼Œåœ¨æ‰§è¡Œå‰ï¼Œè¯·æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Œ
>
> æˆ–è€…ä½¿ç”¨ `--port` å‚æ•°è‡ªå®šä¹‰ä»£ç†ç«¯å£ã€‚

**é¦–æ¬¡**å®‰è£…åï¼Œéœ€è¦è¿›è¡Œåˆå§‹åŒ–ï¼š

```shell
w2 start --init

# Or è‡ªå®šä¹‰ä»£ç†ç«¯å£

w2 start --init --port 4321
```

æ‰§è¡Œ `w2 start --init` ä¼šåšä¸‹é¢å‡ ä»¶äº‹æƒ…ï¼š

#### 1. è®¾ç½®ç³»ç»Ÿå…¨å±€ä»£ç†

å®ƒä¼šå’Œä½ çš„ `ClashX` ç­‰ä»£ç†å†²çªï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå»ºè®®ä½ åœ¨åˆå§‹åŒ–å‰å…³é—­å·²æœ‰çš„å…¨å±€ä»£ç†ã€‚

#### 2. å®‰è£…ç³»ç»Ÿæ ¹è¯ä¹¦

> ä½ åªæœ‰å®‰è£…äº†ç³»ç»Ÿæ ¹è¯ä¹¦ï¼Œæ‰èƒ½å¯¹ https è¯·æ±‚è¿›è¡ŒæŠ“åŒ…ã€‚

æ³¨æ„äº‹é¡¹ï¼š

- Mac éœ€è¦ä¸¤æ¬¡è¾“å…¥å¼€æœºå¯†ç æˆ–æŒ‡çº¹éªŒè¯ï¼š

![mac ca 1](/images/whistle/mac-ca-1.png)
![mac ca 2](/images/whistle/mac-ca-2.png)

- Windows éœ€è¦æœ€åç‚¹å‡» â€œæ˜¯(Y)â€ ç¡®è®¤ï¼š

![windows ca](/images/whistle/windows-ca.jpeg)

#### 3. è®¿é—® WEB UI

å¯åŠ¨ [Whistle](https://github.com/avwo/whistle) åŠé…ç½®å®Œä»£ç†åï¼Œç”¨ `Chrome` æµè§ˆå™¨è®¿é—®é…ç½®é¡µé¢ã€‚

å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼æ¥è®¿é—®é…ç½®é¡µé¢ï¼š

- æ–¹å¼1ï¼šåŸŸåè®¿é—® [http://local.whistlejs.com](http://local.whistlejs.com)ï¼›
- æ–¹å¼2ï¼šip+ç«¯å£è®¿é—® [http://127.0.0.1:8899](http://127.0.0.1:8899)ï¼›

![web ui](/images/whistle/web-ui.png)

![web ui rules](/images/whistle/web-ui-rules.png)

## æ­é… SwitchyOmega

## ç›¸å…³æ–‡æ¡£
